---
title: "Desvendando erros: Entendendo mensagens de erro comuns em R."
date: "2021-03-26"
tags: ["conceitos"]
categories: ["conceitos", "erros", "debugging", "boas pr√°ticas"]
image: "images/posts/banner/dog-pc.jpg"
author: ["Beatriz Milz"]
summary: "Esse post tem como objetivo listar alguns erros comuns quando programamos em R, e dicas de como resolve-los!."
draft: false
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE, 
  message = FALSE, 
  collapse = TRUE,
  fig.align = "center",
  out.width = "80%"
)
```

Quando estamos programando, √© muito comum executar algum c√≥digo e ele gerar um erro! Algumas vezes √© dif√≠cil entender as mensagens de erro para come√ßar a buscar ajuda, e isso pode atrasar nossas tarefas (e tamb√©m nos desanimar).



```{r echo=FALSE, fig.cap="Ilustra√ß√£o por <a href='https://github.com/allisonhorst/stats-illustrations'>Allison Horst</a>"}
knitr::include_graphics("https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/stormyr.gif?raw=true")
```



Principalmente quando estamos iniciando a nossa jornada de aprendizagem de R, alguns erros podem ser mais frequentes. Esse post tem como objetivo listar alguns desses erros comuns, baseado na minha experi√™ncia aprendendo e ensinando R, e tamb√©m respondendo d√∫vidas :)

Vamos ent√£o ler um pouco sobre alguns erros frequentes, e como resolve-los? Prepara um caf√© ou ch√°, e vamos l√°! ‚òï


## Objeto n√£o encontrado

Imagine que queremos calcular a m√©dia do or√ßamento dos filmes que fazem parte da base de dados sobre filmes do IMDB, e recebemos o seguinte erro:

``` r
mean(imdb$orcamento, na.rm = TRUE)
#> Error in mean(imdb$orcamento, na.rm = TRUE): objeto 'imdb' n√£o encontrado
```
<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>

O R est√° dizendo para n√≥s que n√£o est√° encontrando o objeto `imdb`! E como resolver? Precisamos carregar esse objeto no nosso ambiente, para que ele esteja dispon√≠vel para uso!

Para isso, precisamos usar o sinal de atribui√ß√£o: `<-`.

No exemplo abaixo, importamos o arquivo `imdb.csv` e salvamos essa base de dados no objeto `imdb`. Dessa forma, n√£o obtemos um erro quando tentamos calcular a m√©dia da mesma forma que fizemos anteriormente, pois o objeto ser√° encontrado e o c√≥digo conseguir√° ser executado!

```{r}
imdb <- readr::read_csv2("https://raw.githubusercontent.com/curso-r/202010-r4ds-1/master/dados/imdb2.csv")

mean(imdb$orcamento, na.rm = TRUE)
```


## N√£o foi poss√≠vel encontrar a fun√ß√£o "..."

J√° tentou executar um c√≥digo e o retorno foi essa mensagem de erro? 

``` r
glimpse(imdb)
#> Error in glimpse(imdb): n√£o foi poss√≠vel encontrar a fun√ß√£o "glimpse"
```

<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>

Isso significa que o R n√£o encontrou essa fun√ß√£o. No R, podemos instalar pacotes que cont√©m fun√ß√µes para que a gente utilize nas nossas rotinas. Por√©m, √© preciso carregar o pacote para que as fun√ß√µes do mesmpo fiquem dispon√≠veis para uso. Podemos carregar um pacote utilizando a fun√ß√£o `library()`.

No exemplo abaixo, a fun√ß√£o `glimpse()` faz parte do pacote `{dplyr}`. Carregando o pacote no in√≠cio do c√≥digo deixar√° todas as fun√ß√µes do pacote `{dplyr}` dispon√≠veis para uso (incluindo a fun√ß√£o que queremos usar): 


```{r}
library(dplyr)
glimpse(imdb)
```

Outra forma de utilizar a fun√ß√£o sem que seja necess√°rio carregar o pacote, √© utilizando o operador `::` (voc√™ pode ler mais sobre ele [neste cap√≠tulo do livro Zen do R](https://curso-r.github.io/zen-do-r/funcoes-deps.html#quatro-pontos)). 

Leia o c√≥digo abaixo como: quero usar a fun√ß√£o `glimpse()` do pacote `dplyr` 

```{r}
dplyr::glimpse(imdb)
```

## Conflito de fun√ß√µes

```{r include=FALSE}
detach("package:dplyr", unload=TRUE)
```

Um problema silencioso que pode acontecer √© o conflito de fun√ß√µes. Esse tipo de erro √© um pouco mais complicado de identificar pois a mensagem de erro causada por esse problema n√£o √© padronizada.

**Mas o que √© um conflito de fun√ß√µes?**

O R permite que a gente instale e carregue diversos pacotes. E esses pacotes podem ter fun√ß√µes com nomes iguais.

Por exemplo, o pacote `{dplyr}` possui uma fun√ß√£o chamada `filter()`, assim como o pacote `{base}` tamb√©m tem uma fun√ß√£o com o mesmo nome (o `{base}` sempre est√° carregado quando iniciamos o R).

Quando usamos uma fun√ß√£o sem usar o operador `::`, o R vai buscar no ambiente a fun√ß√£o com esse nome que foi carregada por √∫ltimo. Ent√£o podemos usar uma fun√ß√£o A quando queremos realmente usar a fun√ß√£o B.

Exemplo: queremos filtrar os filmes do diretor Zack Snyder. Obtemos esse erro dizendo que o objeto imdb n√£o foi encontrado, por√©m o objeto est√° carregado!

``` r
filter(imdb, diretor == "Zack Snyder")
#> Error in as.ts(x): objeto 'imdb' n√£o encontrado
```
<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>

Isso acontece pois o R utilizou a fun√ß√£o `filter()` do pacote `{base}`, e n√£o a fun√ß√£o `filter()` do pacote `{dplyr}`!


Uma forma de evitar esses erros de conflitos √© utilizar o operador `::`, que foi citado anteriormente. Assim estamos falando explicitamente em qual pacote essa fun√ß√£o est√°:

```{r}
dplyr::filter(imdb, diretor == "Zack Snyder")
```


## N√£o existe um pacote chamado ... / There is no package called .. 

Quando queremos carregar um pacote, e ele n√£o est√° instalado, o erro gerado √© esse:

``` r
library(tidyverse)
#> Error in library(tidyverse) : there is no package called ‚Äòtidyverse‚Äô
```

<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>


Como resolver? Precisamos instalar o pacote!

A forma mais comum de instala√ß√£o de um pacote √© atrav√©s do CRAN, utilizando a fun√ß√£o `install.packages()`:

``` r
install.packages("tidyverse")
```

Ap√≥s instalar o pacote, conseguiremos carregar o pacote normalmente!

``` r
library(tidyverse)
#> ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.0 ‚îÄ‚îÄ
#> ‚úì ggplot2 3.3.3     ‚úì purrr   0.3.4
#> ‚úì tibble  3.1.0     ‚úì dplyr   1.0.5
#> ‚úì tidyr   1.1.3     ‚úì stringr 1.4.0
#> ‚úì readr   1.4.0     ‚úì forcats 0.5.1
#> ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
#> x dplyr::filter() masks stats::filter()
#> x dplyr::lag()    masks stats::lag()
```

##  O pacote ... n√£o est√° dispon√≠vel para essa vers√£o do R / Package '...' is not available for this version of R 

Nesse exemplo, mostraremos um caso onde n√£o √© gerado um erro, e sim uma mensagem de aviso (*warning*). Entretanto, o c√≥digo n√£o executa como esperamos, e pode impossibilitar a execu√ß√£o das etapas seguintes dos scripts.

Imagine que queremos calcular a m√©dia da massa corporal dos Pinguins que fazem parte da base de dados sobre [Pinguins](https://cienciadedatos.github.io/dados/reference/pinguins.html), dispon√≠vel no pacote {[dados](https://cienciadedatos.github.io/dados/)}.

``` r
install.packages("dados")
#> Warning: package 'dados' is not available for this version of R
#> 
#> A version of this package for your version of R might be available elsewhere,
#> see the ideas at
#> https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages
```
<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>

Essa mensagem acontece quando queremos instalar um pacote que n√£o est√° dispon√≠vel no CRAN. 
O que eu recomendo, neste caso, √© buscar o reposit√≥rio no GitHub do pacote desejado.

No caso do pacote que estamos mostrando neste exemplo, [este √© o link do reposit√≥rio](https://github.com/cienciadedatos/dados).


Caso queira instalar o pacote atrav√©s do GitHub, devemos utilizar a fun√ß√£o `install_github()` do pacote `{remotes}`. Como argumento, devemos informar a organiza√ß√£o ou pessoa a quem este reposit√≥rio "pertence", e o nome do reposit√≥rio: `"nome_da_organizacao/nome_do_repositorio"`. No caso do pacote `{dados}`, a organiza√ß√£o √© [cienciadedatos](https://github.com/cienciadedatos), e o reposit√≥rio √© chamado de [dados](https://github.com/cienciadedatos/dados). Portanto, para instalar esse pacote, devemos executar o c√≥digo a seguir: 

``` r
remotes::install_github("cienciadedatos/dados")
```

Agora conseguimos utilizar fun√ß√µes e bases de dados do pacote `dados`:

```{r}
library(dados)
mean(pinguins$massa_corporal, na.rm = TRUE)
```


## O arquivo ... n√£o existe no diret√≥rio de trabalho atual / ... does not exist in current working directory

E quando queremos importar uma base de dados (ou outro arquivo) para trabalhar no R, e recebemos essa mensagem?

``` r
imdb <- readr::read_csv2("imdb2.csv")
#> ‚Ñπ Using ',' as decimal and '.' as grouping mark. Use `read_delim()` for more control.
#> Error: 'imdb2.csv' does not exist in current working directory ('/private/var/folders/z5/nh0wlcsj2fq99rjrj1x7hcwc0000gn/T/RtmpnHTgPb/reprex72f318bb8e33').
```
<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>


O R est√° informando que n√£o encontrou o arquivo que a gente deseja importar. A maior parte das vezes quando esse erro acontece √© por que 1) esse arquivo n√£o existe no nosso computador, ou 2) estamos indicando o caminho incorreto at√© o arquivo.


```{r echo=FALSE, fig.cap="Ilustra√ß√£o sobre projetos no RStudio, por <a href='https://github.com/allisonhorst/stats-illustrations'>Allison Horst</a>"}
knitr::include_graphics("https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/cracked_setwd.png?raw=true")
```

Vamos considerar que j√° sabemos que o arquivo existe no computador, e trabalhar na resolu√ß√£o da segunda op√ß√£o: precisamos corrigir o caminho at√© o arquivo. 
√â muito mais f√°cil lidar com isso quando trabalhamos com projetos no RStudio (`.Rproj`). Recomendo muito ler [esse cap√≠tulo do livro Zen do R](https://curso-r.github.io/zen-do-r/rproj-dir.html#diret%C3%B3rio-de-trabalho), pois fala bastante sobre as vantagens dessa abordagem.

Quando trabalhamos com projetos no RStudio (`.Rproj`), os caminhos s√£o relativos √† pasta raiz do projeto. Recomendo adicionar dentro do seu projeto o arquivo que deseja abrir. E para descobrir o caminho, existe uma super dica: o RStudio nos ajuda a navegar nos arquivos presentes no nosso projeto. √â necess√°rio escrever duas aspas `""`, adicionar o mouse entre elas, e apertar a tecla TAB do teclado. O RStudio possibilitar√° que a gente navegue nos arquivos do nosso projeto dessa forma.


```{r echo=FALSE}
# knitr::include_graphics("images/posts/conteudo/desvendando_erros/rstudio_gif_tab.gif")
```
Descobrindo o caminho correto, podemos importar a base sem que aquele erro seja gerado!

``` r
imdb <- readr::read_csv2("dados/imdb2.csv")
#> ‚Ñπ Using ',' as decimal and '.' as grouping mark. Use `read_delim()` for more control.
#> 
#> ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
#> cols(
#>   titulo = col_character(),
#>   ano = col_double(),
#>   diretor = col_character(),
#>   duracao = col_double(),
#>   cor = col_character(),
#>   generos = col_character(),
#>   pais = col_character(),
#>   classificacao = col_character(),
#>   orcamento = col_double(),
#>   receita = col_double(),
#>   nota_imdb = col_double(),
#>   likes_facebook = col_double(),
#>   ator_1 = col_character(),
#>   ator_2 = col_character(),
#>   ator_3 = col_character()
#> )
```
<sup>Created on 2021-03-26 by the [reprex package](https://reprex.tidyverse.org) (v1.0.0)</sup>


## Conclus√£o

Espero que essas dicas sejam √∫teis para voc√™ resolver os erros no futuro, e voc√™ seja mais feliz enquanto escreve seus c√≥digos em R! E caso ainda tenha d√∫vidas, recomendo perguntar l√° no [F√≥rum Discourse da Curso-R](https://discourse.curso-r.com/)!


```{r echo=FALSE, fig.cap="Ilustra√ß√£o por <a href='https://github.com/allisonhorst/stats-illustrations'>Allison Horst</a>"}
knitr::include_graphics("https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/heartyr.gif?raw=true")
```

## Gostou? Quer saber mais?

Se voc√™ quiser aprender um pouco mais sobre R em geral, d√™ uma olhada nos [Cursos da Curso-R](https://curso-r.com/#portfolio) e aproveite! O pr√≥ximo curso a iniciar √© o [R para Ci√™ncia de Dados II](https://curso-r.com/cursos/r4ds-2/), e a primeira parte do curso √© sobre organiza√ß√£o de projetos, um tema muito presente neste post. üéâ






