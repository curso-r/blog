---
title: "Pacotes miojo - como fazer um pacote no R em 3 minutos [atualizado]"
date: "2022-10-13"
tags: ["miojo"]
categories: ["Tutoriais"]
image: "images/posts/banner/package.webp"
author: ["Julio"]
summary: "[atualizado] Veja como fazer um pacote em R e fazer seus c√≥digos voarem na velocidade da luz"
draft: false
---

```{r include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

Mais de 5 anos atr√°s, escrevi um [blog post](https://blog.curso-r.com/posts/2017-09-07-pacote-miojo/) criando um pacote do zero em minutos. Desde ent√£o, o pacote `{usethis}` emergiu do `{devtools}`, se tornando uma das ferramentas mais queridas da comunidade R. Por isso, fiz uma vers√£o atualizada do mesmo post, utilizando as melhores pr√°ticas dos dias de hoje.

Aqui, veremos como fazer um pacote em R muito, muito r√°pido. Tirei v√°rias coisas que costumo fazer nos pacotes, com dor no cora√ß√£o, tudo pela velocidade, mantendo s√≥ o essencial.

Duas restri√ß√µes s√£o

1.  O pacote precisa ficar dispon√≠vel no GitHub.
2.  O pacote precisa ter pelo menos uma fun√ß√£o.

Essa √© a solu√ß√£o que eu acho mais segura e r√°pida. Voc√™ tamb√©m pode [usar o pr√≥prio RStudio para criar pacotes ou clonar coisas do github](https://blog.curso-r.com/posts/2017-07-17-rstudio-e-github/), mas isso pode dar mais trabalho.

## Passo 1: Crie um projeto de pacote no R

-   Use a fun√ß√£o `usethis::create_package("nomeDoPacote")`
-   Escreva o nome do seu pacote. O nome do pacote n√£o pode ter espa√ßos, underline (`_`) nem h√≠fen (`-`) nem come√ßar com n√∫meros.

Ao fazer isso, o `{usethis}` abrir√° uma nova tela do RStudio, j√° na estrutura de pacote!

![](images/paste-4C36371F.png)

Na tela em que voc√™ escreveu `usethis::create_package()`, o console ficar√° assim:

![](/images/posts/conteudo/2022-10-13-pkg-miojo-2022/paste-4CF58355.png){width="458"}

**Obs**: cuidado para n√£o criar um pacote dentro de um reposit√≥rio Git (por exemplo, dentro de um projeto que voc√™ j√° est√° trabalhando). Isso pode dar problemas de conflito.

## Passo 2: Configurar Git

Rode `usethis::use_git()` e confirme nas duas perguntas que ser√£o feitas a voc√™

![](/images/posts/conteudo/2022-10-13-pkg-miojo-2022/paste-6D455658.png){width="557"}

Sua sess√£o ser√° reiniciada, e o Git est√° configurado üéâ

## Passo 3: configure o GitHub

Rode `usethis::use_github()` e confirme a pergunta que ser√° feita. Aqui estou assumindo que voc√™ tem o Git/GitHub configurado na sua m√°quina. Se n√£o estiver, siga o fluxo do livro [Happy Git With R](https://happygitwithr.com/https-pat.html).

![](/images/posts/conteudo/2022-10-13-pkg-miojo-2022/paste-E41E23E9.png)

Se tudo der certo, seu pacote j√° estar√° dispon√≠vel no seu GitHub!

## Passo 4: Crie sua fun√ß√£o

Exemplo:

```{r eval=FALSE}
#' Soma 2
#'
#' Recebe um vetor de n√∫meros e retorna um vetor de n√∫meros somando dois
#'
#' @param x vetor de n√∫meros.
#'
#' @export
soma_2 <- function(x) {
  x + 2
}
```

1.  Crie a fun√ß√£o dentro de um arquivo com extens√£o `.R` na pasta `R` . Se quiser, voc√™ pode usar a fun√ß√£o `usethis::use_r()` .
2.  As informa√ß√µes que come√ßam com `#'` acima da fun√ß√£o servem para documentar. Nesse caso,
    -   a primeira linha √© o t√≠tulo
    -   a segunda linha √© a descri√ß√£o
    -   a parte que come√ßa com `@param` descreve o que √© o par√¢metro de entrada
    -   a parte que come√ßa com `@export` diz para o pacote que essa fun√ß√£o deve estar dispon√≠vel para o usu√°rio quando ele rodar `library(nomeDoPacote)`.

## Passo 5: document, commit e push!

1.  Rode `devtools::document()`.
2.  Commite suas altera√ß√µes.
3.  D√™ um push!

Se n√£o saba o que √© commitar e pushar, veja o artigo do [Athos](https://blog.curso-r.com/search/?s=Athos) sobre [o uso do git e do GitHub](https://blog.curso-r.com/posts/2017-07-17-rstudio-e-github/).

## Passo 6: Instalar o pacote em outra m√°quina

1.  Mande o nome do seu usu√°rio do GitHub e o nome do seu pacote para sua migue.
2.  Pe√ßa para ela rodar:

```{r eval=FALSE}
remotes::install_github('usuario/nomeDoPacote')
```

1.  Agora ela poder√° usar sua fun√ß√£o!

```{r eval=FALSE}
library(nomeDoPacote)
soma_2(1:10)
# [1]  3  4  5  6  7  8  9 10 11 12
```

Voc√™ tamb√©m pode ver o help da fun√ß√£o com `?soma_2`:

![](/images/posts/conteudo/pacote-miojo/documentacao.webp)

FIM!

## Conclus√µes

-   Agora voc√™ n√£o tem desculpa para n√£o empacotar suas solu√ß√µes em R.
-   Esse tutorial √© incompleto! Para acessar mais detalhes, veja <http://r-pkgs.had.co.nz>, elaborado por voc√™ sabe quem.

## Outras pequenas dicas pr√°ticas

-   Use sempre `devtools::check()` para checar se seu pacote est√° 100% bem constru√≠do.
-   Use `usethis::use_package()` para usar fun√ß√µes de outros pacotes.
-   Sempre use os `::` para chamar as fun√ß√µes e nunca rode `library()` ou `require()` dentro de um pacote.
-   Use `usethis::use_mit_license()` para adicionar um arquivo `LICENSE` ao seu pacote.
-   Use `usethis::use_data()` para adicionar dados ao seu pacote.
-   Use `usethis::use_vignettes()` para escrever um tutorial sobre seu pacote, [igual a esse do dplyr, por exemplo](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html).

√â isso. Happy coding ;)
