<!DOCTYPE html>
<html lang="pt-br"><head>
  <meta charset="utf-8">

  
  <title>Advent of R: Dia 11</title>
  <meta name="title" content="Advent of R: Dia 11">
  <meta name="description" content="Resolvendo o Advent of Code 2021 com R: Dia 11.">

  
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://blog.curso-r.com/posts/2021-12-11-advent-of-r-11/">
  <meta property="og:title" content="Advent of R: Dia 11">
  <meta property="og:description" content="Resolvendo o Advent of Code 2021 com R: Dia 11.">
  <meta property="og:image" content="https://blog.curso-r.com/images/posts/banner/advent-of-r-11.webp?nf_resize=fit&w=300">

  
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://blog.curso-r.com/posts/2021-12-11-advent-of-r-11/">
  <meta property="twitter:title" content="Advent of R: Dia 11">
  <meta property="twitter:description" content="Resolvendo o Advent of Code 2021 com R: Dia 11.">
  <meta property="twitter:image" content="https://blog.curso-r.com/images/posts/banner/advent-of-r-11.webp">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="generator" content="Hugo 0.98.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://blog.curso-r.com/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://blog.curso-r.com/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://blog.curso-r.com/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://blog.curso-r.com/css/custom.css ">
  
  <link rel="stylesheet" href="https://blog.curso-r.com/css/github.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://blog.curso-r.com/css/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://blog.curso-r.com/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://blog.curso-r.com/images/favicon.png " type="image/x-icon">
</head>
<body>
<!-- preloader start -->
<div class="preloader">
  <div class="loader">
    <span class="dot"></span>
    <div class="dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
</div>
<!-- preloader end -->
<header class="navigation">
  <nav class="navbar navbar-expand-lg navbar-light">
    <a class="navbar-brand" href="https://blog.curso-r.com/"><img class="img-fluid" src="https://blog.curso-r.com/images/logo.webp" alt="Blog | Curso-R" width = "200px", height="100px"></a>
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navogation"
      aria-controls="navogation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navogation">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://blog.curso-r.com/">Blog</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://blog.curso-r.com/categories/desafio">Desafios</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://www.curso-r.com/cursos">Cursos</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://discourse.curso-r.com/">Fórum</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://www.curso-r.com">Curso-R</a>
        </li>
        
        
      </ul>
      
      <!-- search -->
      <form class="form-inline position-relative ml-lg-4 form-searh" action="/search">
        <input class="form-control px-0" type="search" placeholder="" id="search-query" name="s">
        <button class="search-icon" type="submit"><i class="ti-search text-dark"></i></button>
      </form>
      
    </div>
  </nav>
</header>



<section class="section bg-posts" style = "background-image: url('https://blog.curso-r.com/images/posts/banner/advent-of-r-11.webp')">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1 class = "titulo-post">Advent of R: Dia 11</h1>
      </div>
    </div>
  </div>
</section>



<section>
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        <ul class="list-inline d-flex justify-content-between py-3">
          <li class="list-inline-item">
            <i class="ti-user mr-2"></i>
            Escrito por
            
            
              <a href = "https://blog.curso-r.com/search/?s=Caio">Caio</a>
            
            em
            <a href="/categories/tutoriais">Tutoriais</a>
          </li>
          <li class="list-inline-item">
            <i class="ti-calendar mr-2"></i>
            11 de
            dezembro de
            2021
          </li>
        </ul>
        <ul class="list-inline tag-list">
          
            <li class="list-inline-item m-1"><a href="/tags/advent-of-r">advent-of-r</a></li>
            <li class="list-inline-item m-1"><a href="/tags/tidyverse">tidyverse</a></li>
        </ul>
        <article class="content">
          
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>O <a href="https://adventofcode.com">Advent of Code</a> é um
<a href="https://pt.wikipedia.org/wiki/Calend%C3%A1rio_do_Advento">Calendário do Advento</a>
desenvolvido por <a href="https://github.com/topaz">Eric Wastl</a> composto por 25
pequenos exercícios de programação que vão sendo disponibilizados, um a um,
entre 1º de dezembro e o Natal de cada ano.</p>
<p>Meu objetivo com o <strong>Advent of R</strong> é resolver todos os problemas do
<a href="https://adventofcode.com/2021">Advent of Code 2021</a> em R e documentar o
processo através desta
<a href="https://blog.curso-r.com/tags/advent-of-r/">série de posts</a>. Todo dia entre
01/12/2021 e 25/12/2021 eu vou tentar resolver o novo problema, documentar a
minha solução aqui no blog e subir os meus scripts completos para um
<a href="https://github.com/curso-r/advent-of-r">repositório público</a> no GitHub.</p>
<p>A minha esperança é que, com essa série, mais pessoas pratiquem seus
conhecimentos de R resolvendo exercícios divertidos e desafiadores! Ao final da
jornada vamos todos ter afiado nossas habilidades de R e, quem sabe, divulgado
essa linguagem incrível para mais pessoas. Boas festas e bom código!</p>
<div id="polvo-dumbo-a" class="section level2">
<h2>Polvo-dumbo (A)</h2>
<p>O <a href="https://adventofcode.com/2021/day/11">dia 11</a> do AoC foi bastante complicado
e o meu código talvez tenha ficado pior ainda. As instruções eram até simples:
recebemos uma matriz 10x10 com os níveis de energia de 100
<a href="https://pt.wikipedia.org/wiki/Grimpoteuthis">polvos-dumbo</a> e precisávamos
acompanhar seus níveis de energia ao longo de 100 iterações. As regras eram as
seguintes:</p>
<ul>
<li><p>Primeiro, o nível de energia de cada polvo sobe em 1.</p></li>
<li><p>Depois, qualquer polvo com nível de energia maior que 9 emite luz (pisca).
Isso aumenta o nível de energia de todos os polvos adjacentes em 1, incluindo os
adjacentes diagonalmente. Se isso causar um polvo a atingir um nível de energia
maior que 9, ele também pisca. Esse processo continua conforme mais polvos
passam do nível de energia 9. Um polvo só pode piscar uma vez por passo e não
pode subir mais nenhum nível de energia a partir daí.</p></li>
<li><p>Finalmente, todos os polvos que piscaram durante este passo têm seus níveis de
energia ajustados para 0 (já que ele usou toda a sua energia para piscar).</p></li>
</ul>
<p>Meu código seguia esse procedimento à risca e precisou de 3 loops aninhados para
funcionar. O truque mais importante foi criar um clone dos polvos que marcava
todos os polvos que já tinham piscado para garantir que nenhum deles ganharia
mais energia durante aquele passo; este mecanismo envolvia marcar um polvo que
piscava com 0 e um polvo que tinha piscado em qualquer ponto anterior do loop
com -1 (para que ele não fosse contado duas vezes). O resultado final deveria
ser o número de piscadas totais depois dos 100 passos.</p>
<pre class="r"><code># Ler matriz
dumbo &lt;- &quot;data-raw/11a_dumbo_octopus.txt&quot; |&gt;
  readr::read_table(col_names = FALSE) |&gt;
  tidyr::separate(X1, paste0(&quot;C&quot;, 0:10), &quot;&quot;) |&gt;
  dplyr::select(-C0) |&gt;
  dplyr::mutate_all(as.numeric) |&gt;
  as.matrix()

# Iterar nos 100 passos
flashes &lt;- 0
for (k in 1:100) {

  # Aumentar níveis de energia
  dumbo &lt;- (dumbo + 1) %% 10

  # Adicionar energia aos polvos cujos vizinhos piscaram
  flag &lt;- FALSE
  while(!flag) {

    # Contar piscadas
    flashes &lt;- flashes + sum(dumbo == 0)

    # Adicionar energia aos polvos adjacentes a piscadas
    dumbo_ &lt;- dumbo
    for (i in 1:10) {
      for (j in 1:10) {

        # Índices dos vizinhos
        i1 &lt;- i - 1
        i2 &lt;- min(i + 1, 10)
        j1 &lt;- j - 1
        j2 &lt;- min(j + 1, 10)

        # Adicionar energia nos índices (exceto no centro)
        if (dumbo[i, j] == 0) {
          dumbo_[i1:i2, j1:j2] &lt;- dumbo_[i1:i2, j1:j2] + 1
          dumbo_[i, j] &lt;- dumbo_[i, j] - 1
        }
      }
    }

    # Separar piscadas anteriores dos que piscaram na última iteração
    dumbo &lt;- ifelse(dumbo == -1, 0, dumbo)

    # Sobrescrever as piscadas com 0 (eles não podem receber mais energia)
    dumbo &lt;- ifelse(dumbo == 0, 0, dumbo_)

    # Verificar se o passo atual acabou
    if (!any(dumbo &gt; 9)) {
      flag &lt;- TRUE
    } else {

      # Prevenir piscadas antigas de serem contadas de novo
      dumbo &lt;- ifelse(dumbo == 0, -1, dumbo)
      dumbo &lt;- ifelse(dumbo &gt; 9, 0, dumbo)
    }
  }
}

# Imprimir
flashes
#&gt; [1] 1681</code></pre>
</div>
<div id="polvo-dumbo-b" class="section level2">
<h2>Polvo-dumbo (B)</h2>
<p>Felizmente o segundo item o exercício de hoje foi bem mais simples.
Eventualmente todos os polvos entram em sincronia, ou seja, passam a piscar
todos juntos; o nosso objetivo era descobrir em que passo isso acontecia. A
única coisa que precisei fazer com o código do item anterior foi ignorar o
limite de passos e criar uma verificação para quando todos os polvos atingiam 0
de energia juntos.</p>
<pre class="r"><code># Ler matriz
dumbo &lt;- &quot;data-raw/11b_dumbo_octopus.txt&quot; |&gt;
  readr::read_table(col_names = FALSE) |&gt;
  tidyr::separate(X1, paste0(&quot;C&quot;, 0:10), &quot;&quot;) |&gt;
  dplyr::select(-C0) |&gt;
  dplyr::mutate_all(as.numeric) |&gt;
  as.matrix()

# Iterar em 1000 passos
for (k in 1:1000) {
  print(k)

  # Aumentar níveis de energia
  dumbo &lt;- (dumbo + 1) %% 10

  # Adicionar energia aos polvos cujos vizinhos piscaram
  flag &lt;- FALSE
  while(!flag) {

    # Adicionar energia aos polvos adjacentes a piscadas
    dumbo_ &lt;- dumbo
    for (i in 1:10) {
      for (j in 1:10) {

        # Índices dos vizinhos
        i1 &lt;- i - 1
        i2 &lt;- min(i + 1, 10)
        j1 &lt;- j - 1
        j2 &lt;- min(j + 1, 10)

        # Adicionar energia nos índices (exceto no centro)
        if (dumbo[i, j] == 0) {
          dumbo_[i1:i2, j1:j2] &lt;- dumbo_[i1:i2, j1:j2] + 1
          dumbo_[i, j] &lt;- dumbo_[i, j] - 1
        }
      }
    }

    # Separar piscadas anteriores dos que piscaram na última iteração
    dumbo &lt;- ifelse(dumbo == -1, 0, dumbo)

    # Sobrescrever as piscadas com 0 (eles não podem receber mais energia)
    dumbo &lt;- ifelse(dumbo == 0, 0, dumbo_)

    # Verificar se o passo atual acabou
    if (!any(dumbo &gt; 9)) {
      flag &lt;- TRUE
    } else {

      # Prevenir piscadas antigas de serem contadas de novo
      dumbo &lt;- ifelse(dumbo == 0, -1, dumbo)
      dumbo &lt;- ifelse(dumbo &gt; 9, 0, dumbo)
    }
  }

  # Parar se todos os polvos tiverem piscado
  if (all(dumbo %in% c(0, -1))) {
    break()
  }
}

# Imprimir
k
#&gt; [1] 276</code></pre>
</div>

          
        </article>
        
  <div class="disqus-comments">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "curso-r-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>


      </div>
      <div class="col-lg-1">
</div>
<div class="col-lg-3">
  
  <div class="widget">
    <h4 class="mb-4">POSTS MAIS RECENTES</h4>
    
    <div class="media mb-4">
      <div class="post-thumb-sm mr-3">
        <a href="https://blog.curso-r.com/posts/2023-04-12-ocr/"><img class="mr-3 post-thumb-sm" src="https://blog.curso-r.com/images/posts/banner/pdf-to-text.webp"></a>
      </div>
      <div class="media-body">
        <h5><a class="text-dark" href="https://blog.curso-r.com/posts/2023-04-12-ocr/">PDF e OCR (atualizado!)</a></h5>
        <p>Por Julio em <a href="/categories/tutoriais">Tutoriais</a></p>
      </div>
    </div>
    
    <div class="media mb-4">
      <div class="post-thumb-sm mr-3">
        <a href="https://blog.curso-r.com/posts/2023-03-06-ordenando-strings/"><img class="mr-3 post-thumb-sm" src="https://blog.curso-r.com/images/posts/banner/ordenando-strings.webp"></a>
      </div>
      <div class="media-body">
        <h5><a class="text-dark" href="https://blog.curso-r.com/posts/2023-03-06-ordenando-strings/">Ordenando strings no R</a></h5>
        <p>Por Caio em <a href="/categories/tutoriais">Tutoriais</a></p>
      </div>
    </div>
    
    <div class="media mb-4">
      <div class="post-thumb-sm mr-3">
        <a href="https://blog.curso-r.com/posts/2023-01-10-css-aleatorio/"><img class="mr-3 post-thumb-sm" src="https://blog.curso-r.com/images/posts/banner/css-aleatorio.webp"></a>
      </div>
      <div class="media-body">
        <h5><a class="text-dark" href="https://blog.curso-r.com/posts/2023-01-10-css-aleatorio/">Como gerar números aleatórios com CSS</a></h5>
        <p>Por Caio em <a href="/categories/tutoriais">Tutoriais</a></p>
      </div>
    </div>
    
  </div>
  <div class="widget">
    <h4 class="mb-4">LEIA MAIS SOBRE</h4>
    <ul class="list-inline tag-list">
      <li class="list-inline-item m-1"><a href="/categories/an%c3%a1lises">Análises</a></li>
      <li class="list-inline-item m-1"><a href="/categories/boas-pr%c3%a1ticas">Boas práticas</a></li>
      <li class="list-inline-item m-1"><a href="/categories/conceitos">Conceitos</a></li>
      <li class="list-inline-item m-1"><a href="/categories/debugging">Debugging</a></li>
      <li class="list-inline-item m-1"><a href="/categories/desafio">Desafio</a></li>
      <li class="list-inline-item m-1"><a href="/categories/discuss%c3%b5es">Discussões</a></li>
      <li class="list-inline-item m-1"><a href="/categories/divulga%c3%a7%c3%a3o">Divulgação</a></li>
      <li class="list-inline-item m-1"><a href="/categories/erros">Erros</a></li>
      <li class="list-inline-item m-1"><a href="/categories/pacotes">Pacotes</a></li>
      <li class="list-inline-item m-1"><a href="/categories/r">R</a></li>
      <li class="list-inline-item m-1"><a href="/categories/top-10">Top 10</a></li>
      <li class="list-inline-item m-1"><a href="/categories/tutoriais">Tutoriais</a></li>
      <li class="list-inline-item m-1"><a href="/categories/tutorial">Tutorial</a></li>
    </ul>
  </div>
</div>

    </div>
  </div>
</section>




<footer class="bg-footer" style = "background-image: url('https://blog.curso-r.com/images/footerImage.webp')">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <a href="https://www.curso-r.com"><img src="https://blog.curso-r.com/images/footerLogo.webp" alt="Blog | Curso-R" class="img-fluid"></a>
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          
          <h6>Dúvidas de R?</h6>
          <ul class="list-unstyled">
            <li class="font-secondary text-dark"><a href="https://discourse.curso-r.com/">Acesse nosso fórum</a></li>
          </ul>
          
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          
          <h6>Fale com a gente</h6>
          <ul class="list-unstyled">
            
            
            <li class="font-secondary text-dark"><a href="mailto:contato@curso-r.com">contato@curso-r.com</a></li>
            
          </ul>
          
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Siga a Curso-R</h6>
          <ul class="list-inline d-inline-block">
            
            <li class="list-inline-item"><a href="https://github.com/curso-r" class="text-dark" target = "_blank"><i class="ti-github"></i></a></li>
            
            <li class="list-inline-item"><a href="https://twitter.com/curso_r" class="text-dark" target = "_blank"><i class="ti-twitter-alt"></i></a></li>
            
            <li class="list-inline-item"><a href="https://www.instagram.com/cursoo_r/" class="text-dark" target = "_blank"><i class="ti-instagram"></i></a></li>
            
            <li class="list-inline-item"><a href="https://br.linkedin.com/company/curso-r" class="text-dark" target = "_blank"><i class="ti-linkedin"></i></a></li>
            
            <li class="list-inline-item"><a href="https://www.facebook.com/cursodeR/" class="text-dark" target = "_blank"><i class="ti-facebook"></i></a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
    <div class="text-center pb-3 copyright">
        <h6 class="mb-0">Copyright © 2021 Curso-R</h6>
        <p class="mb-0" style = "font-size: 0.8em;"> Site feito em <a href = "https://gohugo.io/" target = "_blank">Hugo</a>, com o pacote <a href = "https://bookdown.org/yihui/blogdown/" target = "_blank">Blogdown</a>. Tema por <a href = "https://themefisher.com/" target = "_blank">Themefisher</a>.</p>
    </div>
</footer>



<script>
  var indexURL = "https://blog.curso-r.com/index.json"
</script>


<!-- JS Plugins -->

<script src="https://blog.curso-r.com/plugins/jQuery/jquery.min.js"></script>

<script src="https://blog.curso-r.com/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://blog.curso-r.com/plugins/slick/slick.min.js"></script>

<script src="https://blog.curso-r.com/plugins/headroom/headroom.js"></script>

<script src="https://blog.curso-r.com/plugins/instafeed/instafeed.min.js"></script>

<script src="https://blog.curso-r.com/plugins/masonry/masonry.js"></script>

<script src="https://blog.curso-r.com/plugins/reading-time/readingTime.min.js"></script>

<script src="https://blog.curso-r.com/plugins/smooth-scroll/smooth-scroll.js"></script>

<script src="https://blog.curso-r.com/plugins/search/fuse.min.js"></script>

<script src="https://blog.curso-r.com/plugins/search/mark.js"></script>

<script src="https://blog.curso-r.com/plugins/search/search.js"></script>

<script src="https://blog.curso-r.com/js/highlight.pack.js"></script>

<script src="https://platform.illow.io/banner.js?siteId=962b4071-1b48-4756-8b80-68101acc70df"></script>


<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- Main Script -->

<script src="https://blog.curso-r.com/js/script.min.js"></script>

<!-- google analitycs -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-87272102-2', 'auto');
  ga('send', 'pageview');
</script>





</body>
</html>